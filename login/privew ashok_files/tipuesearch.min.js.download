(function(n){n.fn.tipuesearch=function(t){var i=n.extend({contentLocation:"tipuesearch/tipuesearch_content.json",contextBuffer:60,contextLength:60,contextStart:90,debug:!1,descriptiveWords:25,highlightTerms:!0,liveContent:"*",liveDescription:"*",minimumLength:3,mode:"static",newWindow:!1,show:9,showContext:!0,showRelated:!0,showTime:!0,showTitleCount:!0,showURL:!0,wholeWords:!0},t);return this.each(function(){function o(n){var i=location.search,r=new RegExp("[?|&]"+n+"=([^&;]+?)(&|#|;|$)").exec(i)||[,""],t=r[1].replace(/\+/g,"%20");try{t=decodeURIComponent(t)}catch(u){t=unescape(t)}return t||null}function u(r,o){var l="",ct=!1,yt=!1,rt=!0,d=0,ft,c,a,lt,pt,et,y,at,v,w,b,wt,bt,kt,ot,ut,k,st,g,dt,ht,p,vt,s,it,nt,tt,h;if(found=[],ft=n("#tipue_search_input").val(),c=ft.toLowerCase(),c=n.trim(c),(c.match('^"')&&c.match('"$')||c.match("^'")&&c.match("'$"))&&(rt=!1),a=c.split(" "),rt){for(c="",s=0;s<a.length;s++){for(lt=!0,h=0;h<tipuesearch_stop_words.length;h++)a[s]==tipuesearch_stop_words[h]&&(lt=!1,yt=!0);lt&&(c=c+" "+a[s])}c=n.trim(c);a=c.split(" ")}else c=c.substring(1,c.length-1);if(c.length>=i.minimumLength){if(rt){if(o){for(pt=c,s=0;s<a.length;s++)for(h=0;h<tipuesearch_replace.words.length;h++)a[s]==tipuesearch_replace.words[h].word&&(c=c.replace(a[s],tipuesearch_replace.words[h].replace_with),ct=!0);a=c.split(" ")}for(et=c,s=0;s<a.length;s++)for(h=0;h<tipuesearch_stem.words.length;h++)a[s]==tipuesearch_stem.words[h].word&&(et=et+" "+tipuesearch_stem.words[h].stem);for(a=et.split(" "),s=0;s<t.pages.length;s++){for(y=0,at=t.pages[s].text,h=0;h<a.length;h++){if(v=i.wholeWords?new RegExp("\\b"+a[h]+"\\b","gi"):new RegExp(a[h],"gi"),t.pages[s].title.search(v)!=-1&&(w=t.pages[s].title.match(v).length,y+=20*w),t.pages[s].text.search(v)!=-1&&(w=t.pages[s].text.match(v).length,y+=20*w),t.pages[s].tags.search(v)!=-1&&(w=t.pages[s].tags.match(v).length,y+=10*w),t.pages[s].url.search(v)!=-1&&(y+=20),y!=0)for(b=0;b<tipuesearch_weight.weight.length;b++)t.pages[s].url==tipuesearch_weight.weight[b].url&&(y+=tipuesearch_weight.weight[b].score);a[h].match("^-")&&(v=new RegExp(a[h].substring(1),"i"),(t.pages[s].title.search(v)!=-1||t.pages[s].text.search(v)!=-1||t.pages[s].tags.search(v)!=-1)&&(y=0))}y!=0&&(found.push({score:y,title:t.pages[s].title,desc:at,url:t.pages[s].url}),d++)}}else for(s=0;s<t.pages.length;s++){var y=0,at=t.pages[s].text,v=new RegExp(c,"gi");if(t.pages[s].title.search(v)!=-1&&(w=t.pages[s].title.match(v).length,y+=20*w),t.pages[s].text.search(v)!=-1&&(w=t.pages[s].text.match(v).length,y+=20*w),t.pages[s].tags.search(v)!=-1&&(w=t.pages[s].tags.match(v).length,y+=10*w),t.pages[s].url.search(v)!=-1&&(y+=20),y!=0)for(b=0;b<tipuesearch_weight.weight.length;b++)t.pages[s].url==tipuesearch_weight.weight[b].url&&(y+=tipuesearch_weight.weight[b].score);y!=0&&(found.push({score:y,title:t.pages[s].title,desc:at,url:t.pages[s].url}),d++)}if(d!=0){for(i.showTitleCount&&e==0&&(wt=document.title,document.title="("+d+") "+wt,e++),ct&&(l+='<div id="tipue_search_warning">'+tipuesearch_string_2+" "+c+". "+tipuesearch_string_3+' <a id="tipue_search_replaced">'+pt+"<\/a><\/div>"),d==1?l+='<div id="tipue_search_results_count">'+tipuesearch_string_4:(c_c=d.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),l+='<div id="tipue_search_results_count">'+c_c+" "+tipuesearch_string_5),i.showTime&&(bt=(new Date).getTime(),kt=(bt-startTimer)/1e3,l+=" ("+kt.toFixed(2)+" "+tipuesearch_string_14+")",i.showTime=!1),l+="<\/div>",found.sort(function(n,t){return t.score-n.score}),ot=0,s=0;s<found.length;s++){if(ot>=r&&ot<i.show+r&&(l+='<div class="tipue_search_content_title"><a href="'+found[s].url+'"'+f+">"+found[s].title+"<\/a><\/div>",i.debug&&(l+='<div class="tipue_search_content_debug">Score: '+found[s].score+"<\/div>"),i.showURL&&(ut=found[s].url.toLowerCase(),ut.indexOf("http://")==0&&(ut=ut.slice(7)),l+='<div class="tipue_search_content_url"><a href="'+found[s].url+'"'+f+">"+ut+"<\/a><\/div>"),found[s].desc)){if(k=found[s].desc,i.showContext&&(a=c.split(" "),st=found[s].desc.toLowerCase().indexOf(a[0]),st>i.contextStart&&(g=k.substr(st-i.contextBuffer),dt=g.indexOf(" "),g=k.substr(st-i.contextBuffer+dt),g=n.trim(g),g.length>i.contextLength&&(k="... "+g))),rt)for(a=c.split(" "),h=0;h<a.length;h++)i.highlightTerms&&(ht=new RegExp("("+a[h]+")","gi"),k=k.replace(ht,"<h0011>$1<h0012>"));else i.highlightTerms&&(ht=new RegExp("("+c+")","gi"),k=k.replace(ht,'<span class="tipue_search_content_bold">$1<\/span>'));if(p="",vt=k.split(" "),vt.length<i.descriptiveWords)p=k;else for(h=0;h<i.descriptiveWords;h++)p+=vt[h]+" ";p=n.trim(p);p.charAt(p.length-1)!="."&&(p+=" ...");p=p.replace(/h0011/g,'span class="tipue_search_content_bold"');p=p.replace(/h0012/g,"/span");l+='<div class="tipue_search_content_text">'+p+"<\/div>"}ot++}if(i.showRelated&&rt){for(h=0,s=0;s<tipuesearch_related.searches.length;s++)c==tipuesearch_related.searches[s].search&&(ct&&(ft=c),h||(l+='<div class="tipue_search_related_title">'+tipuesearch_string_15+' <span class="tipue_search_related_bold">'+ft+'<\/span><\/div><div class="tipue_search_related_cols">'),l+='<div class="tipue_search_related_text"><a class="tipue_search_related" id="'+tipuesearch_related.searches[s].related+'">',tipuesearch_related.searches[s].before&&(l+='<span class="tipue_search_related_before">'+tipuesearch_related.searches[s].before+"<\/span> "),l+=tipuesearch_related.searches[s].related,tipuesearch_related.searches[s].after&&(l+=' <span class="tipue_search_related_after">'+tipuesearch_related.searches[s].after+"<\/span>"),l+="<\/a><\/div>",h++);h&&(l+="<\/div>")}if(d>i.show){if(it=Math.ceil(d/i.show),nt=r/i.show,l+='<nav><div id="tipue_search_foot"><ul id="tipue_search_foot_boxes">',r>0&&(l+='<li role="navigation"><a class="tipue_search_foot_box" accesskey="b" id="'+(r-i.show)+"_"+o+'">'+tipuesearch_string_6+"<\/a><\/li>"),nt<=2)for(tt=it,it>3&&(tt=3),h=0;h<tt;h++)l+=h==nt?'<li class="current" role="navigation">'+(h+1)+"<\/li>":'<li role="navigation"><a class="tipue_search_foot_box" id="'+h*i.show+"_"+o+'">'+(h+1)+"<\/a><\/li>";else for(tt=nt+2,tt>it&&(tt=it),h=nt-1;h<tt;h++)l+=h==nt?'<li class="current" role="navigation">'+(h+1)+"<\/li>":'<li role="navigation"><a class="tipue_search_foot_box" id="'+h*i.show+"_"+o+'">'+(h+1)+"<\/a><\/li>";nt+1!=it&&(l+='<li role="navigation"><a class="tipue_search_foot_box" accesskey="m" id="'+(r+i.show)+"_"+o+'">'+tipuesearch_string_7+"<\/a><\/li>");l+="<\/ul><\/div><\/nav>"}}else l+='<div id="tipue_search_warning">'+tipuesearch_string_8+"<\/div>"}else yt?l+='<div id="tipue_search_warning">'+tipuesearch_string_8+". "+tipuesearch_string_9+"<\/div>":(l+='<div id="tipue_search_warning">'+tipuesearch_string_10+"<\/div>",l+=i.minimumLength==1?'<div id="tipue_search_warning">'+tipuesearch_string_11+"<\/div>":'<div id="tipue_search_warning">'+tipuesearch_string_12+" "+i.minimumLength+" "+tipuesearch_string_13+"<\/div>");n("#tipue_search_content").hide().html(l).slideDown(200);n("#tipue_search_replaced").click(function(){u(0,!1)});n(".tipue_search_related").click(function(){n("#tipue_search_input").val(n(this).attr("id"));u(0,!0)});n(".tipue_search_foot_box").click(function(){var i=n(this).attr("id"),t=i.split("_");u(parseInt(t[0]),t[1])})}var t={pages:[]},e,r,f;if(n.ajaxSetup({async:!1}),e=0,n("#tipue_search_content").hide().html('<div class="tipue_search_spinner"><div class="tipue_search_rect1"><\/div><div class="tipue_search_rect2"><\/div><div class="rect3"><\/div><\/div>').show(),i.mode=="live")for(r=0;r<tipuesearch_pages.length;r++)n.get(tipuesearch_pages[r]).done(function(u){var o=n(i.liveContent,u).text(),f,e,s,h;o=o.replace(/\s+/g," ");f=n(i.liveDescription,u).text();f=f.replace(/\s+/g," ");e=u.toLowerCase().indexOf("<title>");s=u.toLowerCase().indexOf("<\/title>",e+7);h=e!=-1&&s!=-1?u.slice(e+7,s):tipuesearch_string_1;t.pages.push({title:h,text:f,tags:o,url:tipuesearch_pages[r]})});i.mode=="json"&&n.getJSON(i.contentLocation).done(function(i){t=n.extend({},i)});i.mode=="static"&&(t=n.extend({},tipuesearch));f="";i.newWindow&&(f=' target="_blank"');o("search_query")&&(n("#tipue_search_input").val(o("search_query")),u(0,!0));n(this).keyup(function(n){n.keyCode=="13"&&u(0,!0)})})}})(jQuery);